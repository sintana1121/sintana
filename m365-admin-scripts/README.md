# Copilot Studio × SharePoint で社内ナレッジ検索AIを構築する【調査時間 15分→5分の実践記録】

## はじめに：なぜ「調査ボット」が必要だったか

テクニカルサポートの現場において、最大の敵は **「情報の分断」** です。

- 膨大な公式Docs：常に更新され、検索性が低い
- 過去のインシデント履歴：解決策が埋もれている
- 散在する社内Wiki：誰の、どのメモが最新か不明
- 個人のローカルメモ：チームに共有されない

1つの複雑なトラブルを解決するのに、10枚のタブを切り替え、複数のソースを横断検索する。この **「調査コスト」** こそが、組織の生産性を蝕む最大の要因でした。

そこで私は、 **「ここさえ聞けば、一次情報のありかがわかる」** というハブを作るべく、Copilot Studio で調査専用AI を構築しました。

> **注記:** これは概念実証（PoC）ではありません。Microsoft 365 サポートの現場で、チームが毎日使っているボットの実運用記録です。

---

## システム構成：Copilot Studio × SharePoint RAG

非常にシンプルかつ強力な RAG（Retrieval-Augmented Generation）を、Copilot Studio の標準機能だけで実装しています。

| コンポーネント | 役割 |
|----------------|------|
| Frontend | Microsoft 365 ポータル（左ペインに常駐） |
| Engine | Microsoft Copilot Studio（Generative AI） |
| Knowledge Source | 特定のSharePointサイト（正規化された過去ログ、最新マニュアル）、Microsoft Learn（管理者向け特定ディレクトリ配下） |

### なぜ Copilot Studio を選んだか

1. **SharePoint連携の速さ**：認証やインデックス作成を意識せず、URL指定だけでセキュアな Knowledge Source 化が可能
2. **エンタープライズ品質の認証**：Microsoft Entra ID で完結し、社内機密の漏洩リスクを最小化
3. **非開発者への継承性**：プログラミング不要。現場リーダーでも迅速にアップデート可能

---

## 実運用の壁：AIを「使える道具」にするための調整

「URLを登録して終わり」――現実はそんなに甘くありません。

現場で使える精度に引き上げるために行った、2つの核心的なチューニングを共有します。

### ① "Garbage In, Garbage Out" の徹底排除

初期段階では過去のインシデントログをすべて読ませましたが、回答精度は絶望的でした。

「古い情報」「誤ったままクローズされたログ」「文脈のないメモ」がAIを混乱させたのです。

**対策：** AI専用の「ゴールデン・フォルダ」をSharePointに作成。検証済みのドキュメント（Final版）のみを厳選して格納。

> **教訓：** AIの精度は、AIの性能よりも、読ませるデータの「清潔さ」で決まる。

### ② 「要約」を禁じ、「根拠」を強要する

初期のAIは綺麗にまとめようとする「優等生」でした。しかし、サポート現場が欲しいのは要約ではなく、 **「どのDocsのどこに書いてあるか」** というエビデンスです。

**対策：** システムプロンプトを以下のように調整。

- 「回答には必ず、参照元ドキュメントのURLを含めること」
- 「不確かな場合は無理に答えず、検索を継続するためのキーワードを提示すること」

Temperature（創造性）を最小限に抑え、事実に忠実な出力を徹底しました。

---

## 実装テクニック：Generative Answers の設定値

Copilot Studio の「会話生成（Generative Answers）」機能を最大化させるための、当現場のベストプラクティスです。

| 項目 | 設定 |
|------|------|
| データソースのフィルタリング | `microsoft.com` 全体ではなく、`https://learn.microsoft.com/ja-jp/microsoft-365/admin/` のようにターゲットを絞り込む |
| モデレーションのレベル | 回答率を優先するため「中（Medium）」に設定。その代わり、人間が必ずダブルチェックを行う運用ルールをセット |

---

## 導入後の成果

運用開始から3ヶ月。以下の成果を確認しています。

| 指標 | Before | After |
|------|--------|-------|
| 一次回答までの調査時間 | 平均 15分 | 平均 5分 |
| 新人教育コスト | 「どこを調べればいいか」を毎回説明 | ボットに聞けば済む |
| ナレッジの自浄作用 | 更新頻度が低い | 「AIが答えられない＝ドキュメント不備」の共通認識が生まれ、更新頻度が向上 |

---

## まとめ：AIは「魔法」ではなく「検索アシスタント」である

Copilot Studio での実装は、技術的には数時間で可能です。

しかし、それを実務で「使える」レベルに昇華させるのは、 **現場の泥臭いデータ整備** と **運用のロジック** です。

今後は Power Automate を介して「回答できなかった質問」を自動抽出し、ナレッジの穴を埋め続ける自律的なサイクルを構築する予定です。

---

## 【無料配布】本記事で使用したシステムプロンプトの構成テンプレート

「要約禁止・根拠必須」の調整を施したプロンプト構成案を含む、 **AI業務活用プロンプト5選** を無料配布しています。

- 調査ボット用プロンプト
- メール校正プロンプト
- FAQ整理プロンプト
- その他、実務で検証済みのテンプレート

👉 **[無料ダウンロードはこちら（メールアドレス登録で即時送付）](https://sintana.site)**

---

## 関連記事

- [M365管理センターで最初にやるべき10の設定](https://qiita.com/SintanaProduction/items/22a5c88b04d730bf0323)
- [【M365】「30分で作った承認フロー」が現場でゴミになる3つの理由と、回避するための実践ガイド](https://qiita.com/SintanaProduction/items/1bdad66207e1f4436b39)

---

## 関連リンク

- [M365管理スクリプト集（GitHub）](https://github.com/sintana1121/sintana/tree/main/m365-admin-scripts)
- [Sintana Production](https://sintana.site)
